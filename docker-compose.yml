# Docker Compose para Migro Hiring Frontend

services:
  # ==========================================
  # Servicio de Desarrollo
  # NOTA: Para desarrollo, ejecuta directamente: npm run dev
  # Este servicio Docker dev ha sido eliminado
  # ==========================================

  # ==========================================
  # Servicio de Producción (nginx)
  # ==========================================
  prod:
    container_name: migro-hiring-prod
    build:
      context: .
      dockerfile: Dockerfile
      # El Dockerfile solo tiene 2 stages: deps, builder, y runner (nginx)
      # Docker usa el último por defecto (runner)
      args:
        - VITE_API_BASE_URL=${VITE_API_BASE_URL:-https://api.migro.es/api}
        - VITE_STRIPE_PUBLISHABLE_KEY=${VITE_STRIPE_PUBLISHABLE_KEY}
        - VITE_APP_URL=${VITE_APP_URL:-https://contratacion.migro.es}
    ports:
      - "80:80"
    networks:
      - migro-network
    restart: unless-stopped
    profiles:
      - production

  # ==========================================
  # Servicio adicional: Mock API (opcional para desarrollo)
  # ==========================================
  mock-api:
    image: stoplight/prism:latest
    container_name: migro-hiring-mock-api
    command: mock -h 0.0.0.0 /openapi.yml
    ports:
      - "8000:4010"
    volumes:
      - ./docker/openapi.yml:/openapi.yml:ro
    networks:
      - migro-network
    profiles:
      - mock
    restart: unless-stopped

networks:
  migro-network:
    driver: bridge

